<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no" />
  <title>WeDoTech - eThekwini Liveability</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="base.css" />
  <link rel="stylesheet" href="liveability.css" />
  <base target="_parent">

  <script>
    document.documentElement.className += window.self == window.top ? " top" : " framed";
  </script>
</head>

<body>
  <div class="container">
    <div class="suburb-container">
      <div class="suburb-title">Suburb</div>
      <div class="suburb-input-container">
        <input id="suburbInput" class="suburb-input" type="text" />
        <ul id="suburbList" class="suburb-list"></ul>
        <div class="suburb-hint">Choose suburb above</div>
      </div>
    </div>

    <div class="row">
      <div class="col-12">
        <div class="title">Overview</div>
        <div class="row">
          <div class="col-12-sm col-12-md col-6-xl col-6-xxl">
            <div class="overview-chart">
              <div class="overview-chart-bg"></div>
              <div class="overview-chart-circle-outer"></div>
              <div class="overview-chart-circle-inner"></div>
              <div class="overview-chart-indicator indicator-range-1">
                <div class="overview-chart-indicator-inner"></div>
              </div>
              <div class="overview-chart-indicator indicator-range-2">
                <div class="overview-chart-indicator-inner"></div>
              </div>
              <div class="overview-chart-indicator indicator-range-3">
                <div class="overview-chart-indicator-inner"></div>
              </div>
              <div class="overview-chart-indicator indicator-range-4">
                <div class="overview-chart-indicator-inner"></div>
              </div>
              <div class="overview-chart-indicator indicator-range-5">
                <div class="overview-chart-indicator-inner"></div>
              </div>
              <div class="overview-chart-indicator-white-line-outer"></div>
              <div class="overview-chart-indicator-white-line-inner"></div>
              <div class="overview-chart-indicator-range-label indicator-range-0">0</div>
              <div class="overview-chart-indicator-range-label indicator-range-20">20</div>
              <div class="overview-chart-indicator-range-label indicator-range-40">40</div>
              <div class="overview-chart-indicator-range-label indicator-range-60">60</div>
              <div class="overview-chart-indicator-range-label indicator-range-80">80</div>
              <div class="overview-chart-indicator-range-label indicator-range-100">100</div>
              <div id="overviewChartIndicatorPointer" class="overview-chart-indicator-pointer"></div>

              <div class="overview-chart-indicator-circle-value"></div>
              <div class="overview-chart-indicator-bottom-mask"></div>
              <div class="overview-chart-liveability-score-container">
                <div id="overviewChartLiveabilityScore" class="overview-chart-liveability-score-value">
                  50
                </div>
                <div class="overview-chart-liveability-score-label">Liveability Score</div>
              </div>
              <div class="overview-chart-population-container">
                <div class="overview-chart-population-label">Total Population</div>
                <div id="overviewChartPopulation" class="overview-chart-population-value"></div>
              </div>
            </div>
          </div>
          <div class="col-12-sm col-12-md col-6-xl col-6-xxl">
            <div class="overview-table">
              <div class="row">
                <div class="col-12">
                  <div class="overview-table-title">Suburb Liveability Information</div>
                </div>
                <div class="row">
                  <div class="col-4">
                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Housing</div>
                      <div class="overview-metric-container">
                        <div id="overviewHousingMarketValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Avg. Property Market Value</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewHousingPropertyValuation" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Avg. Property Valuation</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewHousingSubsidisedValuation" class="overview-metric-value"></div>
                        <div class="overview-metric-label">
                          Avg. Subsidised Property Valuation
                        </div>
                      </div>
                    </div>

                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Health</div>
                      <div class="overview-metric-container">
                        <div id="overviewHealthHospitalsValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Hospitals Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewHealthMobileClinicsValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Mobile Clinics Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewHealthFixedClinicsValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Fixed Clinics Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewHealthParksValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Regional Parks</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewHealthPoolsValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Swimming Pools Within 5kms</div>
                      </div>
                    </div>

                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Transportation</div>
                      <div class="overview-metric-container">
                        <div id="overviewTransportationBusValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Bus & Taxi Ranks Within 5kms</div>
                      </div>
                    </div>

                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Education</div>
                      <div class="overview-metric-container">
                        <div id="overviewEducationInstitutionsValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">
                          Educational Institutions Within 5kms
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-4">
                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Neighbourhood</div>
                      <div class="overview-metric-container">
                        <div id="overviewNeighbourhoodHallsValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Community Halls Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewNeighbourhoodLibrariesValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Libraries Within 5kms</div>
                      </div>
                    </div>

                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Environment</div>
                      <div class="overview-metric-container">
                        <div id="overviewEnvironmentGeohazardsValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Geohazards</div>
                      </div>
                    </div>
                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Opportunity</div>
                      <div class="overview-metric-container">
                        <div class="row align-center">
                          <div id="overviewOpportunityGiniValue" class="overview-metric-value"></div>
                          <div class="overview-metric-data-year">
                            (Year: <span class="overview-metric-sars-data-year"></span>)
                          </div>
                        </div>
                        <div class="overview-metric-label">Avg. Gini Coefficient</div>
                      </div>
                      <div class="overview-metric-container">
                        <div class="row align-center">
                          <div id="overviewOpportunityIncomeValue" class="overview-metric-value"></div>
                          <div class="overview-metric-data-year">
                            (Year:
                            <span class="overview-metric-sars-data-year"></span>
                            )
                          </div>
                        </div>
                        <div class="overview-metric-label">Avg. Median Income</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewOpportunityBillboardsValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Billboards Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewOpportunityBillboardsRateValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Billboards Per 10,000 People</div>
                      </div>
                      <div class="overview-metric-container">
                        <div class="row align-center">
                          <div id="overviewOpportunityEmployeesValue" class="overview-metric-value"></div>
                          <div class="overview-metric-data-year">
                            (Year: <span class="overview-metric-sars-data-year"></span>)
                          </div>
                        </div>
                        <div class="overview-metric-label">Full Time Employees</div>
                      </div>
                      <div class="overview-metric-container">
                        <div class="row align-center">
                          <div id="overviewOpportunityFirmsValue" class="overview-metric-value"></div>
                          <div class="overview-metric-data-year">
                            (Year: <span class="overview-metric-sars-data-year"></span>)
                          </div>
                        </div>
                        <div class="overview-metric-label">Firms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div class="row align-center">
                          <div id="overviewOpportunityFirmsWithinValue" class="overview-metric-value"></div>
                          <div class="overview-metric-data-year">
                            (Year: <span class="overview-metric-sars-data-year"></span>)
                          </div>
                        </div>
                        <div class="overview-metric-label">Firms within 10kms</div>
                      </div>
                    </div>
                  </div>

                  <div class="col-4">
                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Engagement</div>
                      <div class="overview-metric-container">
                        <div id="overviewEngagementSitesValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Cultural Sites Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewEngagementStadiaValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Existing Stadia Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewEngagementWorshipValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Places Of Worship Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewEngagementShoppingValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Shopping Centres Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewEngagementShoppingRateValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">
                          Shopping Centre Rate Per 10,000 People
                        </div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewEngagementVotingRateValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">
                          Voting Station Rate Per 10,000 People
                        </div>
                      </div>
                    </div>

                    <div class="overview-metric-section">
                      <div class="overview-metric-heading">Safety</div>
                      <div class="overview-metric-container">
                        <div id="overviewSafetyCrimeValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Crime Rate Per 10,000 People</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewSafetyDMPSValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">DMPS Stations Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewSafetyFireValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Fire Stations Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewSafetyRoadCrashValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">Road Crash Rate Per 10,000 People</div>
                      </div>
                      <div class="overview-metric-container">
                        <div id="overviewSafetySAPSValue" class="overview-metric-value"></div>
                        <div class="overview-metric-label">SAPS Stations Within 5kms</div>
                      </div>
                      <div class="overview-metric-container">
                        <div class="row align-center">
                          <div id="overviewSafetyCrimeIncidentsValue" class="overview-metric-value"></div>
                          <div class="overview-metric-data-year">
                            (Year: <span class="overview-metric-crime-data-year"></span>)
                          </div>
                        </div>
                        <div class="overview-metric-label">
                          Crime Incidents Within Latest Year
                        </div>
                      </div>
                      <div class="overview-metric-container">
                        <div class="row align-center">
                          <div id="overviewSafetyRoadIncidentsValue" class="overview-metric-value"></div>
                          <div class="overview-metric-data-year">
                            (Year: <span class="overview-metric-road-data-year"></span>)
                          </div>
                        </div>
                        <div class="overview-metric-label">Road Crash Within Latest Year</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row category-scores-section">
      <div class="col-12">
        <div class="title">Category Scores</div>
        <div class="description">
          These are the category scores for
          <span id="currentSuburbText" class="suburb-name"></span>. Explore the metrics and
          policies behind the numbers.
        </div>
        <div class="chart">
          <div class="row">
            <div class="col-3 hidden-sm"></div>
            <div class="col-6">
              <div class="chart-scale">
                <div class="chart-scale-0">0</div>
                <div class="chart-scale-50">
                  <div class="chart-scale-avg-text">Median For Metro</div>
                  <div>50</div>
                </div>
                <div class="chart-scale-100">100</div>
              </div>
            </div>
            <div class="col-3 hidden-sm"></div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/housing.png" width="45" height="42" />
                </div>
                <div class="chart-category-text">Housing</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="housingBar" class="chart-indicator-bar-fill yellow">
                    <div id="housingValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="housingMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="housingMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div id="housingMetricsButton" class="metrics-button" onclick="toggleMetricsTable('housing')">
                  <div class="text">Metrics</div>
                </div>
                <div id="housingPoliciesButton" class="metrics-button" onclick="togglePoliciesTable('housing')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="housingMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="housingPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/neighbourhoood.png" width="25" height="42" />
                </div>
                <div class="chart-category-text">Neighbourhood</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="neighbourhoodBar" class="chart-indicator-bar-fill green--light">
                    <div id="neighbourhoodValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="neighbourhoodMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="neighbourhoodMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div id="neighbourhoodMetricsButton" class="metrics-button"
                  onclick="toggleMetricsTable('neighbourhood')">
                  <div class="text">Metrics</div>
                </div>
                <div id="neighbourhoodPoliciesButton" class="metrics-button"
                  onclick="togglePoliciesTable('neighbourhood')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="neighbourhoodMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="neighbourhoodPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/transportation.png" width="45" height="42" />
                </div>
                <div class="chart-category-text">Transportation</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="transportationBar" class="chart-indicator-bar-fill green">
                    <div id="transportationValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="transportationMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="transportationMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div id="transportationMetricsButton" class="metrics-button"
                  onclick="toggleMetricsTable('transportation')">
                  <div class="text">Metrics</div>
                </div>
                <div id="transportationPoliciesButton" class="metrics-button"
                  onclick="togglePoliciesTable('transportation')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="transportationMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="transportationPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/environment.png" width="45" height="42" />
                </div>
                <div class="chart-category-text">Environment</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="environmentBar" class="chart-indicator-bar-fill blue">
                    <div id="environmentValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="environmentMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="environmentMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div id="environmentMetricsButton" class="metrics-button"
                  onclick="toggleMetricsTable('environment')">
                  <div class="text">Metrics</div>
                </div>
                <div id="environmentPoliciesButton" class="metrics-button"
                  onclick="togglePoliciesTable('environment')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="environmentMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="environmentPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/health.png" width="45" height="42" />
                </div>
                <div class="chart-category-text">Health</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="healthBar" class="chart-indicator-bar-fill blue">
                    <div id="healthValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="healthMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="healthMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div id="healthMetricsButton" class="metrics-button" onclick="toggleMetricsTable('health')">
                  <div class="text">Metrics</div>
                </div>
                <div id="healthPoliciesButton" class="metrics-button" onclick="togglePoliciesTable('health')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="healthMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="healthPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/engagement.png" width="45" height="42" />
                </div>
                <div class="chart-category-text">Engagement</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="engagementBar" class="chart-indicator-bar-fill blue--dark">
                    <div id="engagementValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="engagementMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="engagementMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div id="engagementMetricsButton" class="metrics-button" onclick="toggleMetricsTable('engagement')">
                  <div class="text">Metrics</div>
                </div>
                <div id="engagementPoliciesButton" class="metrics-button"
                  onclick="togglePoliciesTable('engagement')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="engagementMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="engagementPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/opportunity.png" width="45" height="42" />
                </div>
                <div class="chart-category-text">Opportunity</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="opportunityBar" class="chart-indicator-bar-fill green">
                    <div id="opportunityValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="opportunityMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="opportunityMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div class="metrics-button"
                  onclick="toggleMetricsTable('opportunity')">
                  <div class="text">Metrics</div>
                </div>
                <div class="metrics-button"
                  onclick="togglePoliciesTable('opportunity')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="opportunityMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="opportunityPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/education.png" width="45" height="42" />
                </div>
                <div class="chart-category-text">Education</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="educationBar" class="chart-indicator-bar-fill green--light">
                    <div id="educationValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="educationMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="educationMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div id="educationMetricsButton" class="metrics-button" onclick="toggleMetricsTable('education')">
                  <div class="text">Metrics</div>
                </div>
                <div id="educationPoliciesButton" class="metrics-button" onclick="togglePoliciesTable('education')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="educationMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="educationPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>

          <div class="row chart-metric-row">
            <div class="col-3 col-6-sm">
              <div class="chart-category">
                <div class="chart-category-image">
                  <img src="assets/safety.png" width="45" height="42" />
                </div>
                <div class="chart-category-text">Safety</div>
              </div>
            </div>
            <div class="col-6 col-12-sm chart-indicator-col">
              <div class="chart-indicator">
                <div class="chart-indicator-bar">
                  <div id="safetyBar" class="chart-indicator-bar-fill green--light">
                    <div id="safetyValue" class="chart-indicator-value"></div>
                  </div>
                  <div id="safetyMedianBar" class="chart-indicator-median-bar-fill">
                    <div id="safetyMedianValue" class="chart-indicator-median-value"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-3 col-6-sm">
              <div class="chart-options">
                <div id="safetyMetricsButton" class="metrics-button" onclick="toggleMetricsTable('safety')">
                  <div class="text">Metrics</div>
                </div>
                <div id="safetyPoliciesButton" class="metrics-button" onclick="togglePoliciesTable('safety')">
                  <div class="text">Policies</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-12-sm chart-metric-table-col">
              <table id="safetyMetricsTable" class="chart-metric-table hidden"></table>
            </div>
            <div class="col-12 col-12-sm chart-policy-table-col">
              <table id="safetyPoliciesTable" class="chart-policy-table hidden"></table>
            </div>
          </div>
        </div>
      </div>
      <div class="container-fluid hidden-sm">
        <div class="row chart-footer">
          <div class="col-6 col-12-sm chart-footer-col">
            <div class="chart-footer-title">Scoring Essentials</div>
          </div>
          <div class="col-6 col-12-sm chart-footer-col">
            <div class="chart-footer-title">Key Terms</div>
          </div>
        </div>
        <div class="row">
          <div class="col-6 col-12-sm chart-footer-col">
            <div class="chart-footer-text">
              Surprised by the score? Issues surrounding liveable communities are complex and
              interconnected.
            </div>
          </div>
          <div class="col-6 col-12-sm chart-footer-col">
            <div class="chart-footer-text">
              Understanding the basic concepts and terms around the Liveability Index is one step
              toward improving liveability.
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-6 col-12-sm chart-footer-col">
            <div class="chart-footer-link">
              <a href="https://strathub.durban.gov.za/pages/the-liveability-index-explained">Learn more about our methodology and the key factors of liveability ></a>
            </div>
          </div>
          <div class="col-6 col-12-sm chart-footer-col">
            <div class="chart-footer-link">
              <a href="https://strathub.durban.gov.za/pages/the-liveability-index-explained#terms">Learn more about the key terms we use ></a>
            </div>
          </div>
        </div>
      </div>
      <div class="container display-sm">
        <div class="row chart-footer">
          <div class="col-6 col-12-sm">
            <div class="chart-footer-title">Scoring Essentials</div>
            <div class="chart-footer-text">
              Suprised by the score?
              <br />
              <br />
              Issues surrounding liveable communities are complex and interconnected.
            </div>
            <div class="chart-footer-link">
              <a href="https://strathub.durban.gov.za/pages/the-liveability-index-explained">Learn more about our methodology and the key factors of liveability ></a>
            </div>
          </div>
          <div class="col-6 col-12-sm">
            <div class="chart-footer-title">Key Terms</div>
            <div class="chart-footer-text">
              Understanding the basic concepts and terms around the AARP Liveability Index is one
              step toward improving liveability.
            </div>
            <div class="col-6 col-12-sm">
              <div class="chart-footer-link">
                <a href="https://strathub.durban.gov.za/pages/the-liveability-index-explained#terms">Learn more about the key terms we use. > </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row suburb-comparison-section">
      <div class="col-12">
        <div class="title">Compare <span class="suburb-name"></span> to Other Suburbs</div>
        <div class="description">
          Part of understanding the liveability of a location is understanding how that community compares with other communities across the region.
        </div>
        <div class="mt-4" style="font-size: 18px;">Use our Comparison tool to compare up to three different suburbs.</div>
      </div>
      <div class="row comparison-table">
        <div class="row align-center metric">
          <div class="comparison-table-col col-3"></div>
          <div class="comparison-table-col  col-2 comparison-table-header"><span class="hidden-md-down">Median Index</span></div>
          <div class="comparison-table-col  col-2 comparison-table-header"><span class="suburb-name hidden-md-down"></span></div>
          <div class="comparison-table-col  col-2 comparison-table-header comparison-table-suburb-header">
            <div id="suburb1AddButton" class="comparison-table-suburb-plus" onclick="showSuburbInput(1)">
              <span class="icon-suburb-plus">+</span>
              <span class="comparison-table-suburb-text">Add Suburb</span>
            </div>
            <div id="suburb1ComparisionInput" class="suburb-comparison-input-container hidden">
              <input id="suburb1Input" class="comparison-suburb-input" type="text" />
              <ul id="suburb1List" class="suburb-list"></ul>
              <div class="suburb-hint">Choose suburb above</div>
            </div>
            <div class="suburb1-name" onclick="showSuburbInput(1)"></div>
            <div class="suburb-comparison-input-hint suburb1-comparison-input-hint hidden">Choose suburb above</div>
          </div>
          <div class="comparison-table-col  col-2 comparison-table-header comparison-table-suburb-header">
            <div id="suburb2AddButton" class="comparison-table-suburb-plus" onclick="showSuburbInput(2)">
              <span class="icon-suburb-plus">+</span>
              <span class="comparison-table-suburb-text">Add Suburb</span>
            </div>
            <div id="suburb2ComparisionInput" class="suburb-comparison-input-container hidden">
              <input id="suburb2Input" class="comparison-suburb-input" type="text" />
              <ul id="suburb2List" class="suburb-list"></ul>
              <div class="suburb-hint">Choose suburb above</div>
            </div>
            <div class="suburb2-name" onclick="showSuburbInput(2)"></div>
            <div class="suburb-comparison-input-hint suburb2-comparison-input-hint hidden">Choose suburb above</div>
          </div>
          <div class="comparison-table-col col-1"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image"><img width="45" heigh="42" /> </div>
              <div class="chart-category-text">Overall Score</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="overallComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="overallComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="overallComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="overallComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1"></div>
          <div class="comparison-table-line --thick"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/housing.png" width="45" height="42" />
              </div>
              <div class="chart-category-text">Housing</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="housingComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="housingComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="housingComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="housingComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="housingComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('housing')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="housingComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/neighbourhoood.png" width="25" height="42" />
              </div>
              <div class="chart-category-text">Neighbourhood</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="neighbourhoodComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="neighbourhoodComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="neighbourhoodComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="neighbourhoodComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="neighbourhoodComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('neighbourhood')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="neighbourhoodComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/transportation.png" width="45" height="42" />
              </div>
              <div class="chart-category-text">Transportation</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="transportationComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="transportationComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="transportationComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="transportationComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="transportationComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('transportation')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="transportationComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/environment.png" width="45" height="42" />
              </div>
              <div class="chart-category-text">Environment</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="environmentComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="environmentComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="environmentComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="environmentComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="environmentComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('environment')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="environmentComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/health.png" width="45" height="42" />
              </div>
              <div class="chart-category-text">Health</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="healthComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="healthComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="healthComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="healthComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="healthComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('health')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="healthComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/engagement.png" width="45" height="42" />
              </div>
              <div class="chart-category-text">Engagement</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="engagementComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="engagementComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="engagementComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="engagementComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="engagementComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('engagement')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="engagementComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/opportunity.png" width="45" height="42" />
              </div>
              <div class="chart-category-text">Opportunity</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="opportunityComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="opportunityComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="opportunityComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="opportunityComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="opportunityComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('opportunity')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="opportunityComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/education.png" width="45" height="42" />
              </div>
              <div class="chart-category-text">Education</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="educationComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="educationComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="educationComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="educationComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="educationComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('education')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="educationComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
        <div class="row align-center metric">
          <div class="comparison-table-col col-12 col-3-md">
            <div class="row align-center">
              <div class="chart-category-image">
                <img src="assets/safety.png" width="45" height="42" />
              </div>
              <div class="chart-category-text">Safety</div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md">Median Index</div>
              <div class="comparison-table-value" id="safetyComparisonMedian"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb-name"></span></div>
              <div class="comparison-table-value" id="safetyComparisonCurrent"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb1-name"></span></div>
              <div class="comparison-table-value" id="safetyComparisonSuburb1"></div>
            </div>
          </div>
          <div class="comparison-table-col  col-12 col-2-md">
            <div class="row ">
              <div class="hidden-md"><span class="suburb2-name"></span></div>
              <div class="comparison-table-value" id="safetyComparisonSuburb2"></div>
            </div>
          </div>
          <div class="comparison-table-col col-1">
            <div id="safetyComparisonMetricsButton" class="metrics-button hidden-md-down" onclick="toggleComparisonMetricsTable('safety')">
              <div class="text">Metrics</div>
            </div>
          </div>
          <div class="col-12 col-12-sm comparison-metric-table-col">
            <table id="safetyComparisonMetricsTable" class="chart-metric-table hidden hidden-md-down"></table>
          </div>
          <div class="comparison-table-line"></div>
        </div>
      </div>
    </div>
</body>
<script>
  const DEFAULT_SUBURB = "GLENWOOD";
  const CATEGORY_MAP = {
    "Education Opportunities": "education",
    Engagement: "engagement",
    Environment: "environment",
    Health: "health",
    Housing: "housing",
    Neighbourhood: "neighbourhood",
    Opportunity: "opportunity",
    Transport: "transportation",
    Safety: "safety",
  };

  const liveablityIndexCache = {};

  let suburbs = [];
  let categories = {};
  let categoryPolicies = {};

  function formatNumber(value) {
    if (!value && value != 0) {
      return "N/A";
    }
    const splits = value.toString().split(".");
    const part1 = splits[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    let part2 = "";
    if (splits.length > 1) {
      part2 = "." + splits[1];
    }
    return part1 + part2;
  }

  function formatAmount(amount) {
    return `R ${formatNumber(amount)}`;
  }

  function loadSuburbs() {
    return new Promise((resolve, reject) => {
      const url =
        "https://services3.arcgis.com/HO0zfySJshlD6Twu/arcgis/rest/services/Suburb_Overview/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson";
      fetch(url)
        .then((response) => response.json())
        .then((data) => {
          const features = data.features;
          let suburbs = [];
          features.forEach((feature) => {
            suburbs.push(feature.properties);
          });
          // suburbs = suburbs.filter((s) => s.Suburb_Liveability_Index_Val != null);
          suburbs.sort((a, b) => {
            return a.Suburb.localeCompare(b.Suburb);
          });
          resolve(suburbs);
        })
        .catch((error) => {
          reject(error);
        });
    });
  }

  function getLiveabilityCategories(suburb) {
    return new Promise((resolve, reject) => {
      const url = `https://services3.arcgis.com/HO0zfySJshlD6Twu/arcgis/rest/services/Suburb_Liveability_Index_Categories/FeatureServer/0/query?outFields=*&where=Suburb = '${suburb}'&f=geojson`;
      fetch(url)
        .then((response) => response.json())
        .then((data) => {
          const categories = {};
          data.features.forEach((feature) => {
            categories[feature.properties.Category] = {
              index_value: feature.properties.Index_Value,
              median_index_value: feature.properties.Median_Index_Value,
              rank: feature.properties.Rank,
            };
          });
          resolve(categories);
        })
        .catch((error) => {
          reject(error);
        });
    });
  }

  function getLiveabilityIndexValues(suburb) {
    return new Promise((resolve, reject) => {
      if (!suburb) {
        return resolve(null);
      }

      if (liveablityIndexCache[suburb]) {
        return resolve(liveablityIndexCache[suburb]);
      }

      const url = `https://services3.arcgis.com/HO0zfySJshlD6Twu/arcgis/rest/services/Suburb_Liveability_Index_Values/FeatureServer/0/query?outFields=*&where=Suburb = '${suburb}'&f=geojson`;
      fetch(url)
        .then((response) => response.json())
        .then((data) => {
          const indexValues = {};
          data.features.forEach((feature) => {
            const category = feature.properties.Category;
            const value = {
              index_value: feature.properties.Index_Value,
              type: feature.properties.Type,
              median_index_value: feature.properties.Median_Index_Value,
              rank: feature.properties.Rank,
            };

            indexValues[category] = indexValues[category] || [];
            indexValues[category].push(value);
          });

          Object.keys(indexValues).forEach((category) => {
            indexValues[category].sort((a, b) => {
              return a.type.localeCompare(b.type);
            });
          });
          liveablityIndexCache[suburb] = indexValues;
          resolve(indexValues);
        })
        .catch((error) => {
          reject(error);
        });
    });
  }

  function loadCategoryPolicies() {
    const url =
      "https://services3.arcgis.com/HO0zfySJshlD6Twu/arcgis/rest/services/Liveability_Category_By_Laws/FeatureServer/0/query?outFields=*&where=1%3D1&f=geojson";

    return new Promise((resolve, reject) => {
      fetch(url)
        .then((response) => response.json())
        .then((data) => {
          const categories = {};
          data.features.forEach((feature) => {
            const properties = feature.properties;
            const category = properties.Liveability_Category;
            const name = properties.By_Law_Name;
            const url = properties.By_Law_URL;
            const date = properties.Date_Published;
            const domain = new URL(url).hostname;
            categories[category] = categories[category] || [];
            categories[category].push({
              name: name,
              url: url,
              date: date,
              domain: domain,
            });
          });

          Object.keys(categories).forEach((category) => {
            categories[category].sort((a, b) => {
              return a.name.localeCompare(b.name);
            });
          });
          resolve(categories);
        })
        .catch((error) => {
          reject(error);
        });
    });
  }

  function resetChart() {
    Object.values(CATEGORY_MAP).forEach((category) => {
      document.getElementById(`${category}Bar`).style.width = "0%";
      document.getElementById(`${category}Value`).textContent = "";
      document.getElementById(`${category}MedianBar`).style.width = "0%";
      document.getElementById(`${category}MedianValue`).textContent = "";
    });
  }

  function updateChart(categories) {
    // console.log(categories);

    Object.entries(CATEGORY_MAP).forEach(([key, value]) => {
      document
        .getElementById(`${value}Bar`)
        .classList.remove(
          "yellow",
          "green",
          "green--light",
          "blue",
          "blue--dark",
          "red",
          "red--dark"
        );
      const indexValue = categories[key].index_value;
      let colorClass = "yellow";
      if (indexValue > 20 && indexValue <= 40) {
        colorClass = "green--light";
      } else if (indexValue > 40 && indexValue <= 60) {
        colorClass = "green";
      } else if (indexValue > 60 && indexValue <= 80) {
        colorClass = "blue";
      } else if (indexValue > 80) {
        colorClass = "blue--dark";
      }

      document.getElementById(`${value}Bar`).style.width = indexValue + "%";
      document.getElementById(`${value}Value`).textContent = indexValue;
      document.getElementById(`${value}MedianBar`).style.width =
        categories[key].median_index_value + "%";
      document.getElementById(`${value}MedianValue`).textContent =
        categories[key].median_index_value;
      document.getElementById(`${value}Bar`).classList.add(colorClass);


      document.getElementById(`${value}ComparisonMedian`).textContent = categories[key].median_index_value;
      document.getElementById(`${value}ComparisonCurrent`).textContent = indexValue;
    });
  }

  function createChartPolicies(categoryPolicies) {
    // console.log(categoryPolicies);
    Object.keys(categoryPolicies).forEach((key) => {
      const categoryKey = CATEGORY_MAP[key];
      if (!categoryKey) {
        return;
      }

      const tableEl = document.getElementById(`${categoryKey}PoliciesTable`);
      if (!tableEl) {
        return;
      }

      tableEl.innerHTML = "";

      const colgroup = document.createElement("colgroup");
      colgroup.innerHTML = `
          <col span="1" />
          <col span="1" style="width: 160px;" />
          <col span="1" style="width: 120px;" />
        `;

      tableEl.appendChild(colgroup);

      const thead = document.createElement("thead");
      const tr = document.createElement("tr");
      thead.appendChild(tr);
      const th1 = document.createElement("th");
      th1.textContent = `${key} Policies`;
      tr.appendChild(th1);
      const th2 = document.createElement("th");
      th2.textContent = "URL";
      tr.appendChild(th2);
      const th3 = document.createElement("th");
      th3.textContent = "Date";
      tr.appendChild(th3);
      tableEl.appendChild(thead);

      const tbody = document.createElement("tbody");
      categoryPolicies[key].forEach((policy) => {
        const tr = document.createElement("tr");
        tbody.appendChild(tr);
        const td1 = document.createElement("td");
        td1.textContent = policy.name;
        tr.appendChild(td1);
        const td2 = document.createElement("td");
        const a = document.createElement("a");
        a.href = policy.url;
        a.target = "_blank";
        a.textContent = policy.domain;
        td2.appendChild(a);
        tr.appendChild(td2);
        const td3 = document.createElement("td");
        td3.textContent = policy.date;
        tr.appendChild(td3);
      });

      tableEl.appendChild(tbody);
    });
  }

  function createChartMetrics(metrics) {
    // console.log(metrics);

    Object.keys(metrics).forEach((key) => {
      const categoryKey = CATEGORY_MAP[key];
      if (!categoryKey) {
        return;
      }

      const tableEl = document.getElementById(`${categoryKey}MetricsTable`);
      if (!tableEl) {
        return;
      }

      tableEl.innerHTML = "";

      const colgroup = document.createElement("colgroup");
      colgroup.innerHTML = `
          <col span="1" />
          <col span="1" style="width: 80px;" />
          <col span="1" style="width: 100px;" />
          <col span="1" style="width: 80px;" />
        `;

      tableEl.appendChild(colgroup);

      const thead = document.createElement("thead");
      const tr = document.createElement("tr");
      thead.appendChild(tr);
      const th1 = document.createElement("th");
      th1.textContent = `${key} Metrics`;
      tr.appendChild(th1);
      const th2 = document.createElement("th");
      th2.textContent = "Index";
      tr.appendChild(th2);
      const th3 = document.createElement("th");
      th3.textContent = "Median Index";
      tr.appendChild(th3);
      tableEl.appendChild(thead);
      const th4 = document.createElement("th");
      th4.textContent = "Rank";
      tr.appendChild(th4);
      tableEl.appendChild(thead);

      const tbody = document.createElement("tbody");
      metrics[key].forEach((metric) => {
        const tr = document.createElement("tr");
        tbody.appendChild(tr);
        const td1 = document.createElement("td");
        td1.textContent = metric.type;
        tr.appendChild(td1);
        const td2 = document.createElement("td");
        td2.textContent = metric.index_value;
        tr.appendChild(td2);
        const td3 = document.createElement("td");
        td3.textContent = metric.median_index_value;
        tr.appendChild(td3);
        const td4 = document.createElement("td");
        td4.textContent = metric.rank;
        tr.appendChild(td4);
      });

      tableEl.appendChild(tbody);
    });
  }

  loadSuburbs().then((data) => {
    suburbs = data;
    // console.log(suburbs);
  });

  function getSuburbs() {
    return new Promise((resolve, reject) => {
      if (suburbs && suburbs.length > 0) {
        resolve(suburbs);
      } else {
        loadSuburbs()
          .then((data) => {
            suburbs = data;
            resolve(suburbs);
          })
          .catch((err) => {
            reject(err);
          });
      }
    });
  }

  function showSuburbInformation(suburb) {
    getSuburbs().then((suburbs) => {
      const suburbInfo = suburbs.find((s) => s.Suburb === suburb);
      if (!suburbInfo) {
        return;
      }

      document.querySelectorAll(".overview-metric-value").forEach((el) => {
        el.classList.remove("show");
      });

      const crimeDataLatestYear = suburbInfo.Crime_Data_Latest_Yr;
      const roadCrashesLatestYear = suburbInfo.Road_Crashes_Data_Latest_Yr;
      const sarsDataLatestYear = suburbInfo.SARS_Data_Latest_Yr;

      document.getElementById("overviewChartPopulation").textContent = formatNumber(
        suburbInfo.Total_Population
      );

      document.getElementById("overviewChartLiveabilityScore").textContent =
        suburbInfo.Suburb_Liveability_Index_Val;
        document.getElementById("overallComparisonCurrent").textContent =
        suburbInfo.Suburb_Liveability_Index_Val;

      const pointerRotation = (suburbInfo.Suburb_Liveability_Index_Val - 50) * (90 / 50);
      document.getElementById(
        "overviewChartIndicatorPointer"
      ).style.transform = `rotate(${pointerRotation}deg)`;

      document.getElementById("overviewHousingMarketValue").textContent = formatAmount(
        suburbInfo.Avg_Property_Market_Value
      );
      document.getElementById("overviewHousingPropertyValuation").textContent = formatAmount(
        suburbInfo.Avg_Property_Valuation
      );
      document.getElementById("overviewHousingSubsidisedValuation").textContent = formatAmount(
        suburbInfo.Avg_Subsidised_Property_Value
      );

      document.getElementById("overviewNeighbourhoodHallsValue").textContent = formatNumber(
        suburbInfo.Num_Community_Halls_Within_5kms
      );
      document.getElementById("overviewNeighbourhoodLibrariesValue").textContent = formatNumber(
        suburbInfo.Num_Libraries_Within_5kms
      );

      document.getElementById("overviewTransportationBusValue").textContent = formatNumber(
        suburbInfo.Num_Bus_Taxi_Ranks_Within_5kms
      );

      document.getElementById("overviewEnvironmentGeohazardsValue").textContent = formatNumber(
        suburbInfo.Num_Geohazards
      );

      document.getElementById("overviewHealthHospitalsValue").textContent = formatNumber(
        suburbInfo.Num_Hospitals_Within_5kms
      );
      document.getElementById("overviewHealthFixedClinicsValue").textContent = formatNumber(
        suburbInfo.Num_Fixed_Clinics_Within_5kms
      );
      document.getElementById("overviewHealthMobileClinicsValue").textContent = formatNumber(
        suburbInfo.Num_Mobile_Clinics_Within_5kms
      );
      document.getElementById("overviewHealthParksValue").textContent = formatNumber(
        suburbInfo.Num_Regional_Parks
      );
      document.getElementById("overviewHealthPoolsValue").textContent = formatNumber(
        suburbInfo.Num_Swimming_Pools_Within_5kms
      );

      document.getElementById("overviewEngagementSitesValue").textContent = formatNumber(
        suburbInfo.Num_Cultural_Historical_Sites_W
      );
      document.getElementById("overviewEngagementStadiaValue").textContent = formatNumber(
        suburbInfo.Num_Existing_Stadia_Within_5kms
      );
      document.getElementById("overviewEngagementWorshipValue").textContent = formatNumber(
        suburbInfo.Num_Places_Of_Worship_Within_5k
      );
      document.getElementById("overviewEngagementShoppingValue").textContent = formatNumber(
        suburbInfo.Num_Shopping_Centres_Within_5km
      );
      document.getElementById("overviewEngagementShoppingRateValue").textContent = formatNumber(
        suburbInfo.Shopping_Centre_Rate_Per_10000_
      );
      document.getElementById("overviewEngagementVotingRateValue").textContent = formatNumber(
        suburbInfo.Voting_Stations_Per_10000_Peopl
      );

      document.getElementById("overviewOpportunityGiniValue").textContent = formatNumber(
        suburbInfo.Avg_Gini_Coeff
      );
      document.getElementById("overviewOpportunityIncomeValue").textContent = formatNumber(
        suburbInfo.Avg_Median_Income
      );
      document.getElementById("overviewOpportunityBillboardsValue").textContent = formatNumber(
        suburbInfo.Num_Billboards_Within_5kms
      );
      document.getElementById("overviewOpportunityBillboardsRateValue").textContent =
        formatNumber(suburbInfo.Billboard_Rate_Per_10000_People);
      document.getElementById("overviewOpportunityEmployeesValue").textContent = formatNumber(
        suburbInfo.Num_Full_Time_Employees
      );
      document.getElementById("overviewOpportunityFirmsValue").textContent = formatNumber(
        suburbInfo.Num_Firms
      );
      document.getElementById("overviewOpportunityFirmsWithinValue").textContent = formatNumber(
        suburbInfo.Num_Firms_Within_10km
      );

      document.getElementById("overviewEducationInstitutionsValue").textContent = formatNumber(
        suburbInfo.Num_Educational_Institutions_Wi
      );

      document.getElementById("overviewSafetyCrimeValue").textContent = formatNumber(
        suburbInfo.Crime_Rate_Per_10000_People
      );
      document.getElementById("overviewSafetyDMPSValue").textContent = formatNumber(
        suburbInfo.Num_DMPS_Stations_Within_5kms
      );
      document.getElementById("overviewSafetyFireValue").textContent = formatNumber(
        suburbInfo.Num_Fire_Stations_Within_5kms
      );
      document.getElementById("overviewSafetyRoadCrashValue").textContent = formatNumber(
        suburbInfo.Road_Crash_Rate_Per_10000_Peopl
      );
      document.getElementById("overviewSafetySAPSValue").textContent = formatNumber(
        suburbInfo.Num_SAPS_Stations_Within_5kms
      );
      document.getElementById("overviewSafetyCrimeIncidentsValue").textContent = formatNumber(
        suburbInfo.Num_Crime_Incidents_Latest_Yr
      );
      document.getElementById("overviewSafetyRoadIncidentsValue").textContent = formatNumber(
        suburbInfo.Num_Road_Crashes_Latest_Yr
      );

      document.querySelectorAll(".overview-metric-crime-data-year").forEach((el) => {
        el.textContent = crimeDataLatestYear;
      });

      document.querySelectorAll(".overview-metric-road-data-year").forEach((el) => {
        el.textContent = roadCrashesLatestYear;
      });

      document.querySelectorAll(".overview-metric-sars-data-year").forEach((el) => {
        el.textContent = sarsDataLatestYear;
      });

      window.setTimeout(() => {
        document.querySelectorAll(".overview-metric-value").forEach((el) => {
          el.classList.add("show");
        });
      }, 100);
    });
  }

  function loadComparisonData(suburb, index) {
    document.querySelectorAll(`.suburb${index}-name`).forEach((el) => {
      el.textContent = suburb;
    });

    Object.values(CATEGORY_MAP).forEach((val) => {
      document.getElementById(`${val}ComparisonSuburb${index}`).textContent = "";
    });

    getSuburbs().then((suburbs) => {
      const suburbData = suburbs.find((s) => s.Suburb == suburb);
      if (!suburbData) {
        return;
      }

      document.getElementById(`overallComparisonSuburb${index}`).textContent = formatNumber(suburbData.Suburb_Liveability_Index_Val);

      getLiveabilityCategories(suburb).then((catValues) => {
        Object.entries(catValues).forEach(([key, val]) => {
          document.getElementById(`${CATEGORY_MAP[key]}ComparisonSuburb${index}`).textContent = formatNumber(val.index_value);
        });
      });

      getLiveabilityIndexValues(suburb);
    });
  }

  function loadChartData(suburb) {
    if (Object.keys(categoryPolicies) == 0) {
      loadCategoryPolicies().then((data) => {
        categoryPolicies = data;
        createChartPolicies(categoryPolicies);
      });
    }

    showSuburbInformation(suburb);

    getLiveabilityCategories(suburb).then((categories) => {
      getLiveabilityIndexValues(suburb).then((indexValues) => {
        createChartMetrics(indexValues);
      });
      updateChart(categories);
    });
  }

  // Initialize suburbs autocomplete
  const suburbInputEl = document.getElementById("suburbInput");
  const suburbListEl = document.getElementById("suburbList");
  const suburb1InputEl = document.getElementById("suburb1Input");
  const suburb1ListEl = document.getElementById("suburb1List");
  const suburb2InputEl = document.getElementById("suburb2Input");
  const suburb2ListEl = document.getElementById("suburb2List");
  

  function setCurrentSuburbName(suburb) {
    document.querySelectorAll(".suburb-name").forEach((el) => {
      el.textContent = suburb;
    });
  }

  suburbInputEl.addEventListener("input", (e) => changeSuburbAutoComplete(e, suburbListEl));
  suburbInputEl.addEventListener("focus", (e) => changeSuburbAutoComplete(e, suburbListEl));
  suburbListEl.addEventListener("click", (e) => selectSuburbItem(e, updateSuburbInputValue));

  suburb1InputEl.addEventListener("input", (e) => changeSuburbAutoComplete(e, suburb1ListEl));
  suburb1InputEl.addEventListener("focus", (e) => changeSuburbAutoComplete(e, suburb1ListEl));
  suburb1ListEl.addEventListener("click", (e) => selectSuburbItem(e, updateSuburbComparisonInputValue, 1));

  suburb2InputEl.addEventListener("input", (e) => changeSuburbAutoComplete(e, suburb2ListEl));
  suburb2InputEl.addEventListener("focus", (e) => changeSuburbAutoComplete(e, suburb2ListEl));
  suburb2ListEl.addEventListener("click", (e) => selectSuburbItem(e, updateSuburbComparisonInputValue, 2));

  function updateSuburbInputValue(element) {
    const suburb = element.textContent.trim();
    suburbInputEl.value = suburb;
    suburbListEl.innerHTML = ``;
    setCurrentSuburbName(suburb);
    // resetChart();
    loadChartData(suburb);

    Object.values(CATEGORY_MAP).forEach((category) => {
      if (document.getElementById(`${category}ComparisonMetricsButton`).classList.contains("active")) {
        showComparisonIndexValues(category);
      }
    });
  }

  function updateSuburbComparisonInputValue(element, index) {
    const suburb = element.textContent.trim();
    document.getElementById(`suburb${index}Input`).value = suburb;
    document.getElementById(`suburb${index}List`).innerHTML = "";
    document.getElementById(`suburb${index}AddButton`).classList.add("hidden");
    document.getElementById(`suburb${index}ComparisionInput`).classList.add("hidden");
    document.querySelector(`.suburb${index}-comparison-input-hint`).classList.remove("hidden");
    loadComparisonData(suburb, index);

    Object.values(CATEGORY_MAP).forEach((category) => {
      if (document.getElementById(`${category}ComparisonMetricsButton`).classList.contains("active")) {
        showComparisonIndexValues(category);
      }
    });
  } 

  function clearSuburbAutocomplete(event) {
    suburbListEl.innerHTML = "";
  }

  function changeSuburbAutoComplete({ target }, listEl) {
    let data = target.value;
    listEl.innerHTML = ``;
    let autoCompleteValues = suburbAutoComplete(data);
    let listHtml = "";
    autoCompleteValues.forEach((suburb) => {
      listHtml += `<li>
          <div class="suburb-option">
            <div class="suburb-option-suburb" title="${suburb.Suburb}">
              ${suburb.Suburb}
            </div>
            <div class="suburb-option-district" title="${suburb.District}">
              ${suburb.District}
            </div>
          </div>
        </li>`;
    });
    listEl.innerHTML = listHtml;
  }

  function suburbAutoComplete(inputValue) {
    if (!inputValue) {
      return suburbs;
    }

    return suburbs.filter((suburb) =>
      suburb.Suburb.toLowerCase().includes(inputValue.toLowerCase())
    );
  }

  function selectSuburbItem({ target }, callback, value) {
    // console.log(target);
    let element = null;

    if (target.className == "suburb-option") {
      element = target.children[0];
    } else if (target.className == "suburb-option-suburb") {
      element = target;
    } else if (target.className == "suburb-option-district") {
      element = target.previousElementSibling;
    } else {
      return;
    }

    if (element) {
      callback(element, value);
    }
  }

  function createComparisonChartMetrics(category, currentSuburb, currentSuburbValues, suburb1, suburb1Values, suburb2, suburb2Values) {
    const tableEl = document.getElementById(`${category}ComparisonMetricsTable`);
    if (!tableEl) {
      return;
    }

    const categoriesMap = {};
    Object.entries(CATEGORY_MAP).forEach(([key, val]) => {
      categoriesMap[val] = key;
    });

    tableEl.innerHTML = "";

    const categoryName = categoriesMap[category];
    if (!categoryName) {
      return;
    }

    const colgroup = document.createElement("colgroup");
    colgroup.innerHTML = `
        <col span="1" />
        <col span="1" style="width: 100px;" />
        <col span="1" style="width: 120px;" />
        <col span="1" style="width: 120px;" />
        <col span="1" style="width: 120px;" />
      `;

    tableEl.appendChild(colgroup);

    const thead = document.createElement("thead");
    const tr = document.createElement("tr");
    thead.appendChild(tr);
    const th1 = document.createElement("th");
    th1.textContent = `${categoryName} Metrics`;
    tr.appendChild(th1);
    const th2 = document.createElement("th");
    th2.classList.add("text-center");
    th2.textContent = "Median Index";
    tr.appendChild(th2);
    const th3 = document.createElement("th");
    th3.classList.add("text-center");
    th3.textContent = currentSuburb;
    tr.appendChild(th3);
    tableEl.appendChild(thead);
    const th4 = document.createElement("th");
    th4.classList.add("text-center");
    th4.textContent = suburb1;
    tr.appendChild(th4);
    const th5 = document.createElement("th");
    th5.classList.add("text-center");
    th5.textContent = suburb2;
    tr.appendChild(th5);
    tableEl.appendChild(thead);

    const tbody = document.createElement("tbody");
    tableEl.appendChild(tbody);

    const currentMetrics = currentSuburbValues[categoryName];
    let suburb1Metrics = null;
    if (suburb1Values) {
      suburb1Metrics = suburb1Values[categoryName];
    }

    let suburb2Metrics = null;
    if (suburb2Values) {
      suburb2Metrics = suburb2Values[categoryName];
    }

    if (!currentMetrics) {
      return;
    }

    currentMetrics.forEach((metric) => {
      const tr = document.createElement("tr");
      tbody.appendChild(tr);
      const td1 = document.createElement("td");
      td1.textContent = metric.type;
      tr.appendChild(td1);
      const td2 = document.createElement("td");
      td2.classList.add("text-center");
      td2.textContent = metric.median_index_value;
      tr.appendChild(td2);
      const td3 = document.createElement("td");
      td3.classList.add("text-center");
      td3.textContent = metric.index_value;
      tr.appendChild(td3);
      const td4 = document.createElement("td");
      td4.classList.add("text-center");
      if (suburb1Metrics) {
        const suburb1Metric = suburb1Metrics.find((m) => m.type === metric.type);
        if (suburb1Metric) {
          td4.textContent = suburb1Metric.index_value;
        }
      }
      tr.appendChild(td4);
      const td5 = document.createElement("td");
      td5.classList.add("text-center");
      if (suburb2Metrics) {
        const suburb2Metric = suburb2Metrics.find((m) => m.type === metric.type);
        if (suburb2Metric) {
          td5.textContent = suburb2Metric.index_value;
        }
      }
      tr.appendChild(td5);
    });
  }

  function showComparisonIndexValues(category) {
    const currentSuburb = document.getElementById("suburbInput").value;
    const suburb1 = document.getElementById("suburb1Input").value;
    const suburb2 = document.getElementById("suburb2Input").value;

    const promises = [getLiveabilityIndexValues(currentSuburb), getLiveabilityIndexValues(suburb1), getLiveabilityIndexValues(suburb2)];
    Promise.all(promises).then((values) => {
      const currentSuburbValues = values[0];
      const suburb1Values = values[1];
      const suburb2Values = values[2];

      try{
        createComparisonChartMetrics(category, currentSuburb, currentSuburbValues, suburb1, suburb1Values, suburb2, suburb2Values);
      } catch(error) {
        console.error("Failed to create comparison chart metrics", error);
      }
    });
  }

  function showSuburbInput(index) {
    const element = document.getElementById(`suburb${index}ComparisionInput`);
    element.classList.remove("hidden");
    document.getElementById(`suburb${index}Input`).focus();
  }

  function toggleMetricsTable(category) {
    document.getElementById(`${category}PoliciesButton`).classList.remove("active");
    document.getElementById(`${category}MetricsButton`).classList.toggle("active");
    document.getElementById(`${category}PoliciesTable`).classList.add("hidden");
    document.getElementById(`${category}MetricsTable`).classList.toggle("hidden");
  }

  function togglePoliciesTable(category) {
    document.getElementById(`${category}MetricsButton`).classList.remove("active");
    document.getElementById(`${category}PoliciesButton`).classList.toggle("active");
    document.getElementById(`${category}MetricsTable`).classList.add("hidden");
    document.getElementById(`${category}PoliciesTable`).classList.toggle("hidden");
  }

  function toggleComparisonMetricsTable(category) {
    document.getElementById(`${category}ComparisonMetricsButton`).classList.toggle("active");
    document.getElementById(`${category}ComparisonMetricsTable`).classList.toggle("hidden");
    if (document.getElementById(`${category}ComparisonMetricsButton`).classList.contains("active")) {
      showComparisonIndexValues(category);
    }
  }

  // Load initial chart data
  suburbInputEl.value = DEFAULT_SUBURB;
  setCurrentSuburbName(DEFAULT_SUBURB);
  loadChartData(DEFAULT_SUBURB);

</script>
</html>